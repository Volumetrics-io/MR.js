<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>mr.js - skybox</title>
    <meta name="description" content="mr.js example - skybox">
    <script src="/mr.js"></script>
    <link rel="stylesheet" type="text/css" href="skybox-style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body >
   <mr-app debug="false">
    <mr-panel id="panel" class="layout" data-comp-anchor="type: fixed;">
        <mr-div id="navbar">
        <mr-a href="https://mrjs.io" class="mrjs">
            mrjs
        </mr-a>
        <mr-div class="logo">
            <mr-model
            id="logo-model"  
            src="/assets/models/logo.stl" 
            data-comp-instancing="type: animate;"
            data-comp-animation="type: rotate; maxspeed: -0.002; acceleration: -0.000008;"  
            data-rotation="-22.91 17.1887 45.8366">
            </mr-model>
        </mr-div>
        <mr-a href="https://volumetrics.io" class="company">
            volumetrics
        </mr-a>
        </mr-div>

        <mr-text class="col-2 title" >
        Skybox
        </mr-text>
        
        <mr-text class="col-2">
        Skyboxes can enhance your spatial app by making it feel more like a unique virtual environment.
        </mr-text>
        <mr-text class="col-2">
        They can be used to set the scene, bridge virtual and non-virtual situations, and set an ambiance for an area.
        </mr-text>

        <mr-text class="col-2">
        NOTE: This effect is better viewed directly in an MR headset.
        </mr-text>

        <mr-text class="subtitle col-2">
            Examples
        </mr-text>

        <mr-div class="col-2">

            <mr-button onclick="night_sky()" class=" label button" >
                Night Sky - a singular image
            </mr-button>

            <mr-button onclick="daytime()" class=" label button" >
                Daytime - multiple images
            </mr-button>

            <mr-button onclick="cycle()" class=" label button" >
                Cycle / Fade between them and reality
            </mr-button>
            
        </mr-div>
        <mr-text class="col-2 subtitle" >
        mr-skybox
        </mr-text>

        <mr-text class="col-2">
        Skybox setup is achieved using the skybox component, `mr-skybox`, it has one attribute:
        </mr-text>

        <mr-text class="label col-2">
        src
        </mr-text>

        <mr-text class="col-2">
        This src tag can be to singular skybox image file or to a folder with a list of textures image files within it. 
        Internally the system handles how they are loaded so the scene looks right.
        </mr-text>
      
    </mr-panel>

    <mr-skybox id="night_sky" 
        src="/assets/textures/skybox_starmap_4k.jpg"
        data-position="0 -200 0">
        </mr-skybox>

    <mr-skybox id="daytime" 
        src="/assets/textures/skybox_daytime"
        data-position="0 -200 0">
        </mr-skybox>
        
    </mr-app>
  </body>

  <footer>
    <script>

        /**** fade system ****/

        class FadeSystem extends System {
            constructor() {
                super();
                this.skyboxes = document.querySelectorAll("mr-skybox");

            }
            update(deltaTime, frame) {
                this.skyboxes.forEach(skybox => {
                    skybox.opacityLoop()
                });
            }
        }
        var fade = new FadeSystem();

        /**** skyboxes ****/

        let night_sky_entity = document.getElementById('night_sky');
        let daytime_entity = document.getElementById('daytime');

        function night_sky() {
            night_sky_entity.object3D.visible = true;
            daytime_entity.object3D.visible = false;
        }

        function daytime() {
            night_sky_entity.object3D.visible = false;
            daytime_entity.object3D.visible = true;
        }

        function reset() {
            night_sky();
        }

        function cycle() {
            // let count = time / 30;
            // night_sky_entity.setOpacity(count....lerp);
            // daytime_entity.setOpacity(0);
            //     skybox0.setOpacity(0);
            //     skybox1.setOpacity(0);
            //     skybox2.setOpacity(0);
            //     skybox3.setOpacity(0);
            //     island.object3D.visible = false;
            // } else if (container.shuttle.position.y < 0.05) {
            //     skybox0.setOpacity(0.5);
            //     skybox1.setOpacity(0);
            //     skybox2.setOpacity(0);
            //     skybox3.setOpacity(0);
            //     island.object3D.visible = true;
            // } else if (container.shuttle.position.y < 0.6) {
            //     skybox0.setOpacity(0.5);
            //     skybox1.setOpacity(1);
            //     skybox2.setOpacity(0);
            //     skybox3.setOpacity(0);
            //     island.object3D.visible = true;
            // } else if (container.shuttle.position.y < 1.4) {
            //     skybox0.setOpacity(0.5);
            //     skybox1.setOpacity(1);
            //     skybox2.setOpacity(1);
            //     skybox3.setOpacity(0);
            //     island.object3D.visible = true;
            // } else if (container.shuttle.position.y < 10) {
            //     skybox0.setOpacity(0);
            //     skybox1.setOpacity(0);
            //     skybox2.setOpacity(0);
            //     skybox3.setOpacity(0);
            //     island.object3D.visible = false;
            // }
        }

        document.addEventListener('exitXR', () => {
            reset()
        })
      
    </script>
  </footer>
</html>
