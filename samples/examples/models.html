<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>mr.js - models</title>
    <meta name="description" content="mr.js example - models">
    <script src="/mr.js"></script>
    <link rel="stylesheet" type="text/css" href="models-style.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body >
   <mr-app>
    <mr-panel id="panel" class="layout" data-comp-anchor="type: fixed;">
        <mr-div id="navbar">
        <mr-a href="https://mrjs.io" class="mrjs">
            mrjs
        </mr-a>
        <mr-div class="logo">
            <mr-model
            id="logo-model"  
            src="/assets/models/logo.stl" 
            data-comp-instancing="type: animate;"
            data-comp-animation="type: rotate; maxspeed: -0.002; acceleration: -0.000008;"  
            data-rotation="-22.91 17.1887 45.8366">
            </mr-model>
        </mr-div>
        <mr-a href="https://volumetrics.io" class="company">
            volumetrics
        </mr-a>
        </mr-div>

        <mr-text class="col-2 title" >
        Models
        </mr-text>
        
        <mr-text class="col-2">
        Models can enhance the 3D interactive experience of mixed reality making you feel the blend of virtual and real environment more realistically.
        </mr-text>

        <mr-text class="subtitle col-2">
            Examples
        </mr-text>

        <mr-text class="col-2">
        Click on any of the below buttons to make it spin and see which model was loaded for that file type.
        </mr-text>

 <!-- <mr-div class="diptych">
        <mr-div class="gapped padded section">
            <mr-text class="h2">Open-source and extendable</mr-text>
            <mr-text class="narrow">Built on top of web standards, you can implement custom elements and
                contribute to the
                ecosystem.</mr-text>
        </mr-div>
        <mr-div class="section">
            <mr-div class="illustration">
                <mr-model style="scale: 0.03; z-index: 10" src="./assets/koifish.glb"></mr-model>
            </mr-div>
        </mr-div>
    </mr-div> -->


        <mr-div class="col-2">
            <mr-button onclick="stl()" class=" label button" >
                stl
            </mr-button>
        </mr-div>
        <mr-div class="col-2">
            <mr-model 
                id="stl"
                style="scale: 0.0005;"
                src="/assets/models/logo.stl">
            </mr-model>
        </mr-div>

        <mr-div class="col-2">
            <mr-button onclick="glb()" class=" label button" >
                glb
            </mr-button>
        </mr-div>
        <mr-div class="col-2">
            <mr-model 
                id="glb"
                style="scale: 0.00815; z-index: 10"
                src="../assets/models/island3.glb">
            </mr-model>
        </mr-div>

        <mr-div class="col-2">
            <mr-button onclick="glb_anim()" class=" label button" >
                glb - with animation
            </mr-button>
        </mr-div>
        <mr-div class="col-2">
            <mr-model 
                id="glb_anim"
                style="scale: 0.025; z-index: 12"
                src="../assets/models/animation_koifish.glb">
            </mr-model>
        </mr-div>

        <mr-text class="col-2 subtitle" >
        model
        </mr-text>

        <mr-text class="col-2">
        Model loading is achieved using the model component, `mr-model`, it has one attribute:
        </mr-text>

        <mr-text class="label col-2">
        src
        </mr-text>

        <mr-text class="col-2">
        You fill this out as you would any `src` attribute on an <img/> or <video/> html tag. 
        That is, with the path to the file to be loaded (for example `/assets/foo.glb`)
        </mr-text>
      
    </mr-panel>

    </mr-app>
  </body>

  <footer>
    <script src="../assets/js/AnimationSystem.js"></script>
    <script>

        let stl_entity = document.getElementById('stl');
        let glb_entity = document.getElementById('glb');
        let glb_anim_entity = document.getElementById('glb_anim');

        function stl() {
            spin(stl_entity);
        }

        function glb() {
            spin(glb_entity);
        }

        function glb_anim() {
            spin(glb_anim_entity);
        }

        function reset() {
            for (const entity of allModels) {
                stopSin(entity);
            }
        }

        document.addEventListener('exitXR', () => {
            reset()
        })


        // increases the maxspeed and acceleration of the animation component on the logo
        function spin(modelEntity) {
            let animationComp = modelEntity.components.get('animation')
            modelEntity.components.set('animation', {maxspeed: animationComp.maxspeed * 10000, acceleration: animationComp.acceleration * 10000})
        }

        function stopSpin(modelEntity) {
            let animationComp = modelEntity.components.get('animation')
            modelEntity.components.set('animation', {})
        }
      
    </script>
  </footer>
</html>
